// @generated by codegen_tests.py -- DO NOT EDIT
import { describe, it, expect } from "vitest";
import { transpile } from "../../src/index.js";

const DIALECT = "athena";

function validateIdentity(sql: string, writeSql?: string): void {
  const result = transpile(sql, { readDialect: DIALECT, writeDialect: DIALECT })[0];
  expect(result).toBe(writeSql ?? sql);
}

describe("Athena: athena", () => {
  it("SELECT '\\d+'", () => {
    validateIdentity("SELECT '\\d+'");
  });
  it.todo("SELECT 'foo''bar' (unsupported syntax)");
  it.todo("CREATE TABLE IF NOT EXISTS t (name STRING) LOCATION 's3://bucket/tm... (DDL/DML not supported)");
  it.todo("UNLOAD (SELECT name1, address1, comment1, key1 FROM table1) TO 's3:... (check_command_warning)");
  it.todo("USING EXTERNAL FUNCTION some_function(input VARBINARY)\n            ... (check_command_warning)");
  it.todo("/* leading comment */CREATE SCHEMA foo (identify=True not supported)");
  it.todo("/* leading comment */SELECT * FROM foo (identify=True not supported)");
});

describe("Athena: ddl", () => {
  it.todo("CREATE EXTERNAL TABLE foo (id INT) COMMENT 'test comment' (DDL/DML not supported)");
  it.todo("CREATE EXTERNAL TABLE george.t (id INT COMMENT 'foo \\\\ bar') LOCATI... (DDL/DML not supported)");
  it.todo("CREATE EXTERNAL TABLE my_table (id BIGINT COMMENT 'this is the row\\... (DDL/DML not supported)");
  it.todo("CREATE EXTERNAL TABLE foo (id INT, val STRING) CLUSTERED BY (id, va... (DDL/DML not supported)");
  it.todo("CREATE EXTERNAL TABLE foo (id INT, val STRING) STORED AS PARQUET LO... (DDL/DML not supported)");
  it.todo("CREATE EXTERNAL TABLE IF NOT EXISTS foo (a INT, b STRING) ROW FORMA... (DDL/DML not supported)");
  it.todo("CREATE EXTERNAL TABLE x (y INT) ROW FORMAT SERDE 'serde' ROW FORMAT... (DDL/DML not supported)");
  it.todo("CREATE EXTERNAL TABLE `my_table` (`a7` ARRAY<DATE>) ROW FORMAT SERD... (DDL/DML not supported)");
  it.todo("CREATE TABLE iceberg_table (`id` BIGINT, `data` STRING, category ST... (DDL/DML not supported)");
  it.todo("CREATE OR REPLACE TABLE iceberg_table (`id` BIGINT, `data` STRING, ... (DDL/DML not supported)");
  it.todo("CREATE TABLE foo WITH (table_type='ICEBERG', location='s3://foo/', ... (DDL/DML not supported)");
  it.todo("CREATE TABLE foo WITH (table_type='HIVE', external_location='s3://f... (DDL/DML not supported)");
  it.todo("CREATE TABLE foo AS WITH foo AS (SELECT a, b FROM bar) SELECT * FRO... (DDL/DML not supported)");
  it.todo("ALTER TABLE `foo`.`bar` ADD COLUMN `end_ts` BIGINT (DDL/DML not supported)");
  it.todo("ALTER TABLE `foo` DROP COLUMN `id` (DDL/DML not supported)");
});

describe("Athena: dml", () => {
  it.todo("SELECT CAST(ds AS VARCHAR) AS ds FROM (VALUES ('2022-01-01')) AS t(ds) (unsupported syntax)");
});

describe("Athena: ddl_quoting", () => {
  it.todo("CREATE SCHEMA `foo` (DDL/DML not supported)");
  it.todo("CREATE SCHEMA foo (DDL/DML not supported)");
  it.todo("CREATE EXTERNAL TABLE `foo` (`id` INT) LOCATION 's3://foo/' (DDL/DML not supported)");
  it.todo("CREATE EXTERNAL TABLE foo (id INT) LOCATION 's3://foo/' (DDL/DML not supported)");
  it.todo("CREATE EXTERNAL TABLE foo (id INT) LOCATION 's3://foo/' (identify=True not supported)");
  it.todo("CREATE TABLE foo AS SELECT * FROM a (DDL/DML not supported)");
  it.todo('CREATE TABLE "foo" AS SELECT * FROM "a" (DDL/DML not supported)');
  it.todo('DROP VIEW IF EXISTS "foo"."bar" (DDL/DML not supported)');
  it.todo('CREATE VIEW "foo" AS SELECT "id" FROM "tbl" (DDL/DML not supported)');
  it.todo("CREATE VIEW foo AS SELECT id FROM tbl (identify=True not supported)");
  it.todo("DROP TABLE `foo` (DDL/DML not supported)");
  it.todo("DROP TABLE foo (DDL/DML not supported)");
  it.todo("DROP TABLE foo (identify=True not supported)");
  it.todo('CREATE VIEW "foo" AS SELECT "id" FROM "tbl" (DDL/DML not supported) (2)');
  it.todo("CREATE VIEW foo AS SELECT id FROM tbl (DDL/DML not supported)");
  it.todo("CREATE VIEW foo AS SELECT id FROM tbl (identify=True not supported) (2)");
  it.todo('CREATE SCHEMA "foo" (DDL/DML not supported)');
  it.todo('DROP TABLE "foo" (DDL/DML not supported)');
  it.todo("DESCRIBE foo.bar (identify=True not supported)");
  it.todo('CREATE TABLE "foo" AS WITH "foo" AS (SELECT "a", "b" FROM "bar") SE... (DDL/DML not supported)');
});

describe("Athena: dml_quoting", () => {
  it("SELECT a AS foo FROM tbl", () => {
    validateIdentity("SELECT a AS foo FROM tbl");
  });
  it('SELECT "a" AS "foo" FROM "tbl"', () => {
    validateIdentity('SELECT "a" AS "foo" FROM "tbl"');
  });
  it.todo("INSERT INTO foo (id) VALUES (1) (DDL/DML not supported)");
  it.todo('INSERT INTO "foo" ("id") VALUES (1) (DDL/DML not supported)');
  it.todo("UPDATE foo SET id = 3 WHERE id = 7 (DDL/DML not supported)");
  it.todo('UPDATE "foo" SET "id" = 3 WHERE "id" = 7 (DDL/DML not supported)');
  it.todo("DELETE FROM foo WHERE id > 10 (DDL/DML not supported)");
  it.todo('DELETE FROM "foo" WHERE "id" > 10 (DDL/DML not supported)');
  it("WITH foo AS (SELECT a, b FROM bar) SELECT * FROM foo", () => {
    validateIdentity("WITH foo AS (SELECT a, b FROM bar) SELECT * FROM foo");
  });
  it.todo("WITH foo AS (SELECT a, b FROM bar) SELECT * FROM foo (identify=True not supported)");
});

describe("Athena: create_table", () => {
  it.todo("test_create_table: assertEqual call");
  it.todo("test_create_table: assertEqual call (2)");
});

describe("Athena: ctas", () => {
  it.todo("test_ctas: assertEqual call");
  it.todo("test_ctas: assertEqual call (2)");
  it.todo("test_ctas: assertEqual call (3)");
  it.todo("test_ctas: assertEqual call (4)");
});

describe("Athena: parse_partitioned_by_returns_iceberg_transforms", () => {
  it.todo("test_parse_partitioned_by_returns_iceberg_transforms: assert statement");
  it.todo("test_parse_partitioned_by_returns_iceberg_transforms: assert statement (2)");
  it.todo("test_parse_partitioned_by_returns_iceberg_transforms: assert statement (3)");
  it.todo("test_parse_partitioned_by_returns_iceberg_transforms: assert statement (4)");
});
