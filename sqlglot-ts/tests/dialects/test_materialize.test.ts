// @generated by codegen_tests.py -- DO NOT EDIT
import { describe, it, expect } from "vitest";
import { transpile } from "../../src/index.js";

const DIALECT = "materialize";

function validateIdentity(sql: string, writeSql?: string): void {
  const result = transpile(sql, { readDialect: DIALECT, writeDialect: DIALECT })[0];
  expect(result).toBe(writeSql ?? sql);
}

describe("Materialize: materialize", () => {
  it.todo("CREATE TABLE example (id INT PRIMARY KEY, name TEXT) (DDL/DML not supported)");
  it.todo("INSERT INTO example (id, name) VALUES (1, 'Alice') ON CONFLICT(id) ... (DDL/DML not supported)");
  it.todo("CREATE TABLE example (id SERIAL, name TEXT) (DDL/DML not supported)");
  it.todo("CREATE TABLE example (id INT AUTO_INCREMENT, name TEXT) (DDL/DML not supported)");
  it.todo(`SELECT JSON_EXTRACT_PATH_TEXT('{ "farm": {"barn": { "color": "red",... (unsupported syntax)`);
  it.todo("materialize -> duckdb: SELECT MAP['a' => 1] (unsupported syntax)");
  it("materialize -> materialize: SELECT MAP['a' => 1]", () => {
    const result = transpile("SELECT MAP['a' => 1]", { readDialect: DIALECT, writeDialect: "materialize" })[0];
    expect(result).toBe("SELECT MAP['a' => 1]");
  });
  it("CURRENT_TIMESTAMP", () => {
    validateIdentity("CURRENT_TIMESTAMP");
  });
  it.todo("NOW() (unsupported syntax)");
  it("MZ_NOW()", () => {
    validateIdentity("MZ_NOW()");
  });
  it("SELECT CAST(1 AS mz_timestamp)", () => {
    validateIdentity("SELECT CAST(1 AS mz_timestamp)");
  });
  it.todo("CREATE TABLE example (id INT, name LIST) (DDL/DML not supported)");
  it("SELECT LIST[]", () => {
    validateIdentity("SELECT LIST[]");
  });
  it("SELECT LIST[1, 2, 3]", () => {
    validateIdentity("SELECT LIST[1, 2, 3]");
  });
  it("SELECT LIST[LIST[1], LIST[2], NULL]", () => {
    validateIdentity("SELECT LIST[LIST[1], LIST[2], NULL]");
  });
  it("SELECT CAST(LIST[1, 2, 3] AS INT LIST)", () => {
    validateIdentity("SELECT CAST(LIST[1, 2, 3] AS INT LIST)");
  });
  it("SELECT CAST(NULL AS INT LIST)", () => {
    validateIdentity("SELECT CAST(NULL AS INT LIST)");
  });
  it("SELECT CAST(NULL AS INT LIST LIST LIST)", () => {
    validateIdentity("SELECT CAST(NULL AS INT LIST LIST LIST)");
  });
  it("SELECT LIST(SELECT 1)", () => {
    validateIdentity("SELECT LIST(SELECT 1)");
  });
  it("SELECT MAP[]", () => {
    validateIdentity("SELECT MAP[]");
  });
  it("SELECT MAP['a' => MAP['b' => 'c']]", () => {
    validateIdentity("SELECT MAP['a' => MAP['b' => 'c']]");
  });
  it("SELECT CAST(MAP['a' => 1] AS MAP[TEXT => INT])", () => {
    validateIdentity("SELECT CAST(MAP['a' => 1] AS MAP[TEXT => INT])");
  });
  it("SELECT CAST(NULL AS MAP[TEXT => INT])", () => {
    validateIdentity("SELECT CAST(NULL AS MAP[TEXT => INT])");
  });
  it("SELECT CAST(NULL AS MAP[TEXT => MAP[TEXT => INT]])", () => {
    validateIdentity("SELECT CAST(NULL AS MAP[TEXT => MAP[TEXT => INT]])");
  });
  it("SELECT MAP(SELECT 'a', 1)", () => {
    validateIdentity("SELECT MAP(SELECT 'a', 1)");
  });
});
