// @generated by codegen_tests.py -- DO NOT EDIT
import { describe, it, expect } from "vitest";
import { transpile } from "../../src/index.js";

const DIALECT = "druid";

function validateIdentity(sql: string, writeSql?: string): void {
  const result = transpile(sql, { readDialect: DIALECT, writeDialect: DIALECT })[0];
  expect(result).toBe(writeSql ?? sql);
}

describe("Druid: druid", () => {
  it("SELECT MOD(1000, 60)", () => {
    validateIdentity("SELECT MOD(1000, 60)");
  });
  it("SELECT CEIL(__time TO WEEK) FROM t", () => {
    validateIdentity("SELECT CEIL(__time TO WEEK) FROM t");
  });
  it("SELECT CEIL(col) FROM t", () => {
    validateIdentity("SELECT CEIL(col) FROM t");
  });
  it("SELECT CEIL(price, 2) AS rounded_price FROM t", () => {
    validateIdentity("SELECT CEIL(price, 2) AS rounded_price FROM t");
  });
  it("SELECT FLOOR(__time TO WEEK) FROM t", () => {
    validateIdentity("SELECT FLOOR(__time TO WEEK) FROM t");
  });
  it("SELECT FLOOR(col) FROM t", () => {
    validateIdentity("SELECT FLOOR(col) FROM t");
  });
  it("SELECT FLOOR(price, 2) AS rounded_price FROM t", () => {
    validateIdentity("SELECT FLOOR(price, 2) AS rounded_price FROM t");
  });
  it("SELECT CURRENT_TIMESTAMP", () => {
    validateIdentity("SELECT CURRENT_TIMESTAMP");
  });
  it.todo("SELECT ARRAY[1, 2, 3] (unsupported syntax)");
  it.todo("test_druid: unresolvable write dict");
});
