// @generated by codegen_tests.py -- DO NOT EDIT
import { describe, it, expect } from "vitest";
import { transpile } from "../../src/index.js";

const DIALECT = "tableau";

function validateIdentity(sql: string, writeSql?: string): void {
  const result = transpile(sql, { readDialect: DIALECT, writeDialect: DIALECT })[0];
  expect(result).toBe(writeSql ?? sql);
}

describe("Tableau: tableau", () => {
  it("tableau -> hive: [x]", () => {
    const result = transpile("[x]", { readDialect: DIALECT, writeDialect: "hive" })[0];
    expect(result).toBe("`x`");
  });
  it("tableau -> tableau: [x]", () => {
    const result = transpile("[x]", { readDialect: DIALECT, writeDialect: "tableau" })[0];
    expect(result).toBe("[x]");
  });
  it('tableau -> hive: "x"', () => {
    const result = transpile('"x"', { readDialect: DIALECT, writeDialect: "hive" })[0];
    expect(result).toBe("'x'");
  });
  it('tableau -> tableau: "x"', () => {
    const result = transpile('"x"', { readDialect: DIALECT, writeDialect: "tableau" })[0];
    expect(result).toBe("'x'");
  });
  it("presto -> tableau: IF(x = 'a', y, NULL)", () => {
    const result = transpile("IF(x = 'a', y, NULL)", { readDialect: "presto", writeDialect: DIALECT })[0];
    expect(result).toBe("IF x = 'a' THEN y ELSE NULL END");
  });
  it("tableau -> presto: IF x = 'a' THEN y ELSE NULL END", () => {
    const result = transpile("IF x = 'a' THEN y ELSE NULL END", { readDialect: DIALECT, writeDialect: "presto" })[0];
    expect(result).toBe("IF(x = 'a', y, NULL)");
  });
  it("tableau -> hive: IF x = 'a' THEN y ELSE NULL END", () => {
    const result = transpile("IF x = 'a' THEN y ELSE NULL END", { readDialect: DIALECT, writeDialect: "hive" })[0];
    expect(result).toBe("IF(x = 'a', y, NULL)");
  });
  it("tableau -> tableau: IF x = 'a' THEN y ELSE NULL END", () => {
    const result = transpile("IF x = 'a' THEN y ELSE NULL END", { readDialect: DIALECT, writeDialect: "tableau" })[0];
    expect(result).toBe("IF x = 'a' THEN y ELSE NULL END");
  });
  it("presto -> tableau: COALESCE(a, 0)", () => {
    const result = transpile("COALESCE(a, 0)", { readDialect: "presto", writeDialect: DIALECT })[0];
    expect(result).toBe("IFNULL(a, 0)");
  });
  it("tableau -> presto: IFNULL(a, 0)", () => {
    const result = transpile("IFNULL(a, 0)", { readDialect: DIALECT, writeDialect: "presto" })[0];
    expect(result).toBe("COALESCE(a, 0)");
  });
  it("tableau -> hive: IFNULL(a, 0)", () => {
    const result = transpile("IFNULL(a, 0)", { readDialect: DIALECT, writeDialect: "hive" })[0];
    expect(result).toBe("COALESCE(a, 0)");
  });
  it("tableau -> tableau: IFNULL(a, 0)", () => {
    const result = transpile("IFNULL(a, 0)", { readDialect: DIALECT, writeDialect: "tableau" })[0];
    expect(result).toBe("IFNULL(a, 0)");
  });
  it("presto -> tableau: COUNT(DISTINCT a)", () => {
    const result = transpile("COUNT(DISTINCT a)", { readDialect: "presto", writeDialect: DIALECT })[0];
    expect(result).toBe("COUNTD(a)");
  });
  it("tableau -> presto: COUNTD(a)", () => {
    const result = transpile("COUNTD(a)", { readDialect: DIALECT, writeDialect: "presto" })[0];
    expect(result).toBe("COUNT(DISTINCT a)");
  });
  it("tableau -> hive: COUNTD(a)", () => {
    const result = transpile("COUNTD(a)", { readDialect: DIALECT, writeDialect: "hive" })[0];
    expect(result).toBe("COUNT(DISTINCT a)");
  });
  it("tableau -> tableau: COUNTD(a)", () => {
    const result = transpile("COUNTD(a)", { readDialect: DIALECT, writeDialect: "tableau" })[0];
    expect(result).toBe("COUNTD(a)");
  });
  it("presto -> tableau: COUNT(DISTINCT(a))", () => {
    const result = transpile("COUNT(DISTINCT(a))", { readDialect: "presto", writeDialect: DIALECT })[0];
    expect(result).toBe("COUNTD((a))");
  });
  it("tableau -> presto: COUNTD((a))", () => {
    const result = transpile("COUNTD((a))", { readDialect: DIALECT, writeDialect: "presto" })[0];
    expect(result).toBe("COUNT(DISTINCT (a))");
  });
  it("tableau -> hive: COUNTD((a))", () => {
    const result = transpile("COUNTD((a))", { readDialect: DIALECT, writeDialect: "hive" })[0];
    expect(result).toBe("COUNT(DISTINCT (a))");
  });
  it("tableau -> tableau: COUNTD((a))", () => {
    const result = transpile("COUNTD((a))", { readDialect: DIALECT, writeDialect: "tableau" })[0];
    expect(result).toBe("COUNTD((a))");
  });
  it("presto -> tableau: COUNT(a)", () => {
    const result = transpile("COUNT(a)", { readDialect: "presto", writeDialect: DIALECT })[0];
    expect(result).toBe("COUNT(a)");
  });
  it("tableau -> presto: COUNT(a)", () => {
    const result = transpile("COUNT(a)", { readDialect: DIALECT, writeDialect: "presto" })[0];
    expect(result).toBe("COUNT(a)");
  });
  it("tableau -> hive: COUNT(a)", () => {
    const result = transpile("COUNT(a)", { readDialect: DIALECT, writeDialect: "hive" })[0];
    expect(result).toBe("COUNT(a)");
  });
  it("tableau -> tableau: COUNT(a)", () => {
    const result = transpile("COUNT(a)", { readDialect: DIALECT, writeDialect: "tableau" })[0];
    expect(result).toBe("COUNT(a)");
  });
});
